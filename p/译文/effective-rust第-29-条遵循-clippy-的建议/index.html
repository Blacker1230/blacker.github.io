<!doctype html><html lang=zh-Hans dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="本文为 effective-rust 第 29 条的译文。"><title>【译文/effective-rust】第 29 条：遵循 Clippy 的建议</title>
<link rel=canonical href=https://liyan-ah.github.io/p/%E8%AF%91%E6%96%87/effective-rust%E7%AC%AC-29-%E6%9D%A1%E9%81%B5%E5%BE%AA-clippy-%E7%9A%84%E5%BB%BA%E8%AE%AE/><link rel=stylesheet href=/scss/style.min.8e60baf4cd3fc55968717a6e39762f4d28ed7ef6007566b6c7970ad0fe907198.css><meta property='og:title' content="【译文/effective-rust】第 29 条：遵循 Clippy 的建议"><meta property='og:description' content="本文为 effective-rust 第 29 条的译文。"><meta property='og:url' content='https://liyan-ah.github.io/p/%E8%AF%91%E6%96%87/effective-rust%E7%AC%AC-29-%E6%9D%A1%E9%81%B5%E5%BE%AA-clippy-%E7%9A%84%E5%BB%BA%E8%AE%AE/'><meta property='og:site_name' content='李岩'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='译文'><meta property='article:tag' content='effective-rust'><meta property='article:published_time' content='2024-09-08T16:30:36+08:00'><meta property='article:modified_time' content='2024-09-08T16:30:36+08:00'><meta name=twitter:title content="【译文/effective-rust】第 29 条：遵循 Clippy 的建议"><meta name=twitter:description content="本文为 effective-rust 第 29 条的译文。"><link rel="shortcut icon" href=/icon.jpg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu16177073813840188542.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>李岩</a></h1><h2 class=site-description>努力做个工程师。</h2></div></header><ol class=menu-social><li><a href=https://github.com/liyan-ah/liyan-ah.github.io/issues/new target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#注释>注释</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E7%A8%8B%E5%BA%8F%E4%BA%BA%E7%94%9F/ style=background-color:#2a9d8f;color:#fff>程序人生</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E8%AF%91%E6%96%87/effective-rust%E7%AC%AC-29-%E6%9D%A1%E9%81%B5%E5%BE%AA-clippy-%E7%9A%84%E5%BB%BA%E8%AE%AE/>【译文/effective-rust】第 29 条：遵循 Clippy 的建议</a></h2><h3 class=article-subtitle>本文为 effective-rust 第 29 条的译文。</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 08, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 5 分钟</time></div></footer></div></header><section class=article-content><blockquote><p>“看起来你在写信。需要什么帮助么？” —— <a class=link href=https://en.wikipedia.org/wiki/Office_Assistant target=_blank rel=noopener>Microsoft Clippit</a></p></blockquote><p><a class=link href=https://www.lurklurk.org/effective-rust/use-tools.html target=_blank rel=noopener>第 31 条</a>会描述了 Rust 工具箱中一些很有用的工具。但是其中一个特别有用且重要的工具值的在这里进行进行单独的介绍：<a class=link href=https://github.com/rust-lang/rust-clippy#clippy target=_blank rel=noopener>Clippy</a>。</p><p>Clippy 是 Cargo 的一个附加模块（通过<code>cargo clippy</code>的方式调用）。它可以生成涵盖多种类别的<code>warining</code>信息：</p><ul><li>正确性：提示常见的编程错误。</li><li>风格：提示不完全符合 Rust 标准风格的代码结构。</li><li>简洁性：指出能让代码更加简洁的可行变更。</li><li>性能：提示能避免无效处理或者内存分配的可选项。</li><li>可读性：给出能让代码更易读或者更易懂的建议。</li></ul><p>比如，如下这段代码编译是正常的：</p><div class=ferris><img src=../images/ferris/not_desired_behavior.svg width=75 height=75></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>pub</span><span class=w> </span><span class=k>fn</span> <span class=nf>circle_area</span><span class=p>(</span><span class=n>radius</span>: <span class=kt>f64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>f64</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>pi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>3.14</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pi</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>radius</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>radius</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>但是 Clippy 会指出这里对 π 的近似赋值是没必要且不准确的：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=n>error</span>: <span class=nc>approximate</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=err>`</span><span class=n>f</span><span class=p>{</span><span class=mi>32</span><span class=p>,</span><span class=w> </span><span class=mi>64</span><span class=p>}</span>::<span class=n>consts</span>::<span class=no>PI</span><span class=err>`</span><span class=w> </span><span class=n>found</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=o>-</span>-&gt; <span class=nc>src</span><span class=o>/</span><span class=n>main</span><span class=p>.</span><span class=n>rs</span>:<span class=mi>5</span>:<span class=mi>18</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=kd>let</span><span class=w> </span><span class=n>pi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>3.14</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>|</span><span class=w>                  </span><span class=o>^^^^</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=n>help</span>: <span class=nc>consider</span><span class=w> </span><span class=n>using</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>constant</span><span class=w> </span><span class=n>directly</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=n>help</span>: <span class=nc>for</span><span class=w> </span><span class=n>further</span><span class=w> </span><span class=n>information</span><span class=w> </span><span class=n>visit</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>https</span>:<span class=c1>//rust-lang.github.io/rust-clippy/master/index.html#approx_constant
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=o>=</span><span class=w> </span><span class=n>note</span>: <span class=err>`</span><span class=cp>#[deny(clippy::approx_constant)]</span><span class=err>`</span><span class=w> </span><span class=n>on</span><span class=w> </span><span class=n>by</span><span class=w> </span><span class=n>default</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>链接中的文档解释了问题并且给出了优化代码的方式。上述示例可调整为：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>pub</span><span class=w> </span><span class=k>fn</span> <span class=nf>circle_area</span><span class=p>(</span><span class=n>radius</span>: <span class=kt>f64</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>f64</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>std</span>::<span class=kt>f64</span>::<span class=n>consts</span>::<span class=no>PI</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>radius</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>radius</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>正如示例中所展示的，每个 Clippy 警告都会伴随着一个网页的链接来描述问题。链接的网页中会说明为什么目标代码会被认为是不恰当的。这些说明很重要：它们的存在使得你可以自行判断采纳这些建议或者由于特殊的原因而忽略它们。有的时候，说明文本中还会描述一些校验器的已知问题，这些描述会解释一些令人困惑的误报。</p><p>如果你认定一些警告信息和自己的代码没有关系，你可以通过添加(#[allow(clippy::some_line)])来忽略关联代码的报错，或者在包的顶层（top level）添加(#![allow(clipy::some_lint)])来忽略整个包中的警告信息。通常情况下，建议调整目标代码而非花费很多时间来确认警告关联的代码是否是一个罕见的误报。</p><p>无论你选择了修复或者忽略掉这些警告信息，请<strong>确保你的代码中没有 Clippy-warning 的信息</strong>。</p><p>这样，当新的警告信息出现时 —— 无论是由于代码发生了调整还是 Clippy 升级后包含了新的校验信息 —— 我们就能够及时的关注到。Clippy 也应当被纳入你的持续集成系统中（<a class=link href=https://www.lurklurk.org/effective-rust/ci.html target=_blank rel=noopener>第 32 条</a>）。</p><p>Clippy 的警告信息在你学习 Rust 时特别重要，因为它们可以揭示那些被你忽略的细节，并帮助你熟悉 Rust 的风格。</p><p>本书中提到的很多建议，在 Clippy 中均存在相关的警告信息：</p><ul><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_1/item1-use-types.html target=_blank rel=noopener>第 1 条</a>建议使用更具表现力的类型，而非一般的<code>bool</code>类型。Clippy 也指出了在<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/fn_params_excessive_bools target=_blank rel=noopener>函数参数</a>以及<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/struct_excessive_bools target=_blank rel=noopener>结构体</a>中使用多个<code>bool</code>类型的问题。</li><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_1/item3-transform.html target=_blank rel=noopener>第 3 条</a>包括了一些<code>Option</code>及<code>Result</code>类型的操作。Clippy 指出了一些可行的精简行为，比如：<ul><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/ok_expect target=_blank rel=noopener>Unnecessarily converting <code>Result</code> to <code>Option</code></a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/unwrap_or_else_default target=_blank rel=noopener>Opportunities to use <code>unwrap_or_default</code></a>。</li></ul></li><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_1/item3-transform.html target=_blank rel=noopener>第 3 条</a>同样建议了应当将错误返回给调用方。Clippy [指出了应当返回的地方]。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/from_over_into target=_blank rel=noopener>第 5 条</a>应当实现<code>From</code>特征而非<code>Into</code>。</li><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_1/item5-casts.html target=_blank rel=noopener>第 5 条</a>还描述了一些强制转换，而 Clippy 给出了如下的警告（对应的检查项默认是关掉的）：<ul><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/cast_lossless target=_blank rel=noopener><code>as</code> casts that could be from instead</a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/cast_possible_truncation target=_blank rel=noopener><code>as</code> casts that might truncate</a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/cast_possible_wrap target=_blank rel=noopener><code>as</code> casts that might wrap</a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/cast_precision_loss target=_blank rel=noopener><code>as</code> casts that lose precision</a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/cast_sign_loss target=_blank rel=noopener><code>as</code> casts that might convert signed negative numbers to large positive numbers</a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/as_conversions target=_blank rel=noopener>any use of <code>as</code></a>。</li></ul></li><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_1/item8-references&amp;pointer.html target=_blank rel=noopener>第 8 条</a>描述了胖指针类型，并且很多 Clippy 的校验器指出了一些非必要的额外的指针间接访问：<ul><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/box_collection target=_blank rel=noopener>Holding a heap-allocated collection in a <code>Box</code></a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/vec_box target=_blank rel=noopener>Holding a heap-allocated collection of <code>Box</code> items</a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/borrowed_box target=_blank rel=noopener>Taking a reference to a <code>Box</code></a>。</li></ul></li><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_1/item9-iterators.html target=_blank rel=noopener>第 9 条</a>描述了操作<code>Iterator</code>实例的诸多方法。Clippy 包含了诸多的可以简化迭代器方法使用的校验器<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。</li><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_2/item10-std-traits.html target=_blank rel=noopener>第 10 条</a>描述了 Rust 的标准特性，并且包含了很多 Clippy 会校验到的实现时的要求：<ul><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/derive_ord_xor_partial_ord target=_blank rel=noopener><code>Ord</code> must agree with <code>PartialOrd</code></a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/partialeq_ne_impl target=_blank rel=noopener><code>PartialEq::ne</code> should not need a nondefault implementation</a>（参照 <a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_2/item13-use-default-impl.html target=_blank rel=noopener>第 13 条</a>）。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/derived_hash_with_manual_eq target=_blank rel=noopener><code>Hash</code> and <code>Eq</code> must be consistent</a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/expl_impl_clone_on_copy target=_blank rel=noopener><code>Clone</code> for <code>Copy</code> types should match</a>。</li></ul></li><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_3/item18-panic.html target=_blank rel=noopener>第 18 条</a>提供了一些关于减少<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/panic target=_blank rel=noopener><code>panic!</code></a>或类似<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/expect_used target=_blank rel=noopener><code>expect</code></a>的方法，这些建议也会在 Clippy 的校验器中检查到。</li><li><a class=link href=https://www.lurklurk.org/effective-rust/semver.html target=_blank rel=noopener>第 21 条</a>表述了引入通过通配符限定的包是不明智的。Clippy 同样对此<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/wildcard_dependencies target=_blank rel=noopener>进行了校验</a>。</li><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_4/item23-wildcard.html target=_blank rel=noopener>第 23 条</a>及<a class=link href=https://www.lurklurk.org/effective-rust/dep-graph.html target=_blank rel=noopener>第 25 条</a>涉及到一种不同版本的包出现在同一个项目的依赖中。Clippy 可以通过配置，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/multiple_crate_versions target=_blank rel=noopener>在问题出现时给出警告信息</a>。</li><li><a class=link href=https://www.lurklurk.org/effective-rust/features.html target=_blank rel=noopener>第 26 条</a>叙述了 Cargo 特性的一些相加性，而 Clippy 会将与此原则相违背特性提示为<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/negative_feature_names target=_blank rel=noopener>“否定”的特性</a>。</li><li><a class=link href=https://www.lurklurk.org/effective-rust/features.html target=_blank rel=noopener>第 26 条</a>同样表述了一个包的可选依赖项同样是其特征集的一部分。如果存在<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/redundant_feature_names target=_blank rel=noopener>需要明确的特性名（如：&ldquo;use-crate-x"形式的命名）</a>时，Clippy 将会提示直接应当使用明确的特性名，而非模糊的。</li><li><a class=link href=https://rustx-labs.github.io/effective-rust-cn/chapter_5/item27-document-public-interfaces.html target=_blank rel=noopener>第 27 条</a>描述了文档注释的约束，Clippy 同时有如下的提示：<ul><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/missing_panics_doc target=_blank rel=noopener>Missing descriptions of <code>panic!</code>s</a>。</li><li><a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/missing_safety_doc target=_blank rel=noopener>Missing descriptions</a> of <a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/undocumented_unsafe_blocks target=_blank rel=noopener><code>unsafe</code> concerns</a>。</li></ul></li></ul><p>上述的信息无疑说明了<strong>阅读 <a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html target=_blank rel=noopener>Clippy 的警告信息</a>列表</strong>同样是一种有意义的学习方式 —— 包括那些默认被关掉校验的原因，是由于它们太严苛了还是由于它们会产生虚警？尽管你可能并不希望代码中出现这么多的警告信息，领悟这些校验规则出现的原因将会提升你对 Rust 及其风格的理解。</p><h3 id=注释><a href=#%e6%b3%a8%e9%87%8a>#</a>
注释</h3><p>原文<a class=link href=https://www.lurklurk.org/effective-rust/clippy.html target=_blank rel=noopener>点这里</a>查看</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>部分校验器列举如下。<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/explicit_counter_loop target=_blank rel=noopener>explicit_counter_loop</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/explicit_iter_loop target=_blank rel=noopener>explicit_iter_loop</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/explicit_into_iter_loop target=_blank rel=noopener>explicit_into_iter_loop</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/filter_map_identity target=_blank rel=noopener>filter_map_identity</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/from_iter_instead_of_collect target=_blank rel=noopener>from_iter_instead_of_collect</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/into_iter_on_ref target=_blank rel=noopener>into_iter_on_ref</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/iter_count target=_blank rel=noopener>iter_count</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/iter_next_loop target=_blank rel=noopener>iter_next_loop</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/iter_not_returning_iterator target=_blank rel=noopener>iter_not_returning_iterator</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/manual_filter_map target=_blank rel=noopener>manual_filter_map</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/manual_find_map target=_blank rel=noopener>manual_find_map</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/map_clone target=_blank rel=noopener>map_clone</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/needless_range_loop target=_blank rel=noopener>needless_range_loop</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/search_is_some target=_blank rel=noopener>search_is_some</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/skip_while_next target=_blank rel=noopener>skip_while_next</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/suspicious_map target=_blank rel=noopener>suspicious_map</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/unnecessary_filter_map target=_blank rel=noopener>unnecessary_filter_map</a>，<a class=link href=https://rust-lang.github.io/rust-clippy/stable/index.html#/unnecessary_fold target=_blank rel=noopener>unnecessary_fold</a>。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></section><footer class=article-footer><section class=article-tags><a href=/tags/%E8%AF%91%E6%96%87/>译文</a>
<a href=/tags/effective-rust/>Effective-Rust</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/%E8%AF%91%E6%96%87/effective-rust%E7%AC%AC-30-%E6%9D%A1%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF%E5%8D%95%E6%B5%8B/><div class=article-details><h2 class=article-title>【译文/effective-rust】第 30 条：不仅仅是单测</h2></div></a></article><article><a href=/p/%E8%AF%91%E6%96%87/effective-rust%E7%AC%AC-28-%E6%9D%A1%E5%9C%A8%E5%90%88%E9%80%82%E7%9A%84%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E5%AE%8F/><div class=article-details><h2 class=article-title>【译文/effective-rust】第 28 条：在合适的时候使用宏</h2></div></a></article><article><a href=/p/%E8%AF%91%E6%96%87/effective-rust%E7%AC%AC-27-%E6%9D%A1%E4%B8%BA%E5%85%AC%E5%85%B1%E6%8E%A5%E5%8F%A3%E6%92%B0%E5%86%99%E6%96%87%E6%A1%A3/><div class=article-details><h2 class=article-title>【译文/effective-rust】第 27 条：为公共接口撰写文档</h2></div></a></article><article><a href=/p/emacs-%E5%AD%97%E7%AC%A6%E6%93%8D%E4%BD%9C%E5%BF%AB%E6%8D%B7%E9%94%AE/><div class=article-details><h2 class=article-title>Emacs 字符操作快捷键</h2></div></a></article><article><a href=/p/bpftrace-%E9%81%8D%E5%8E%86-golang-%E9%93%BE%E8%A1%A8go17-/><div class=article-details><h2 class=article-title>bpftrace 遍历 golang 链表（go17+）</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2019 -
2024 李岩</section><section class=powerby>Hello, World!<br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.25.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>